{% comment %}
This is a reusable dropdown component using Tailwind CSS.
Usage:
{% include 'core/components/common/dropdown_tailwind.html' with 
    dropdown_id="uniqueDropdownId" (required)
    dropdown_text="Dropdown" 
    dropdown_button_type="primary" (options: primary, secondary, success, danger, warning, info, light, dark)
    dropdown_button_size="md" (options: sm, md, lg)
    dropdown_button_class="" (optional, additional classes)
    dropdown_items=dropdown_items (list of dictionaries with 'url', 'text', 'icon_class' (optional))
    dropdown_align="right" (optional, default: left, options: left, right)
    is_outline=True (optional, default: False)
    icon_class="fas fa-caret-down" (optional)
%}

Example dropdown_items:
[
    {'url': '#', 'text': 'Action', 'icon_class': 'fas fa-bolt'},
    {'url': '#', 'text': 'Another action'},
    {'divider': True},
    {'url': '#', 'text': 'Something else here'}
]
{% endcomment %}

<div class="relative inline-block text-left" x-data="{ open: false }" @click.away="open = false" @keydown.escape.window="open = false">
    <!-- Dropdown button -->
    <button type="button" 
            id="{{ dropdown_id }}_button"
            @click="open = !open"
            aria-haspopup="true" 
            aria-expanded="false"
            class="inline-flex items-center justify-center rounded-lg font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
                   {% if is_outline %}
                     {% if dropdown_button_type == 'primary' %}border border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500
                     {% elif dropdown_button_type == 'secondary' %}border border-gray-500 text-gray-500 hover:bg-gray-50 focus:ring-gray-400
                     {% elif dropdown_button_type == 'success' %}border border-green-600 text-green-600 hover:bg-green-50 focus:ring-green-500
                     {% elif dropdown_button_type == 'danger' %}border border-red-600 text-red-600 hover:bg-red-50 focus:ring-red-500
                     {% elif dropdown_button_type == 'warning' %}border border-yellow-500 text-yellow-500 hover:bg-yellow-50 focus:ring-yellow-400
                     {% elif dropdown_button_type == 'info' %}border border-blue-400 text-blue-400 hover:bg-blue-50 focus:ring-blue-300
                     {% elif dropdown_button_type == 'light' %}border border-gray-300 text-gray-600 hover:bg-gray-50 focus:ring-gray-300
                     {% elif dropdown_button_type == 'dark' %}border border-gray-800 text-gray-800 hover:bg-gray-100 focus:ring-gray-700
                     {% else %}border border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500{% endif %}
                   {% else %}
                     {% if dropdown_button_type == 'primary' %}bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500
                     {% elif dropdown_button_type == 'secondary' %}bg-gray-500 hover:bg-gray-600 text-white focus:ring-gray-400
                     {% elif dropdown_button_type == 'success' %}bg-green-600 hover:bg-green-700 text-white focus:ring-green-500
                     {% elif dropdown_button_type == 'danger' %}bg-red-600 hover:bg-red-700 text-white focus:ring-red-500
                     {% elif dropdown_button_type == 'warning' %}bg-yellow-500 hover:bg-yellow-600 text-white focus:ring-yellow-400
                     {% elif dropdown_button_type == 'info' %}bg-blue-400 hover:bg-blue-500 text-white focus:ring-blue-300
                     {% elif dropdown_button_type == 'light' %}bg-gray-100 hover:bg-gray-200 text-gray-800 focus:ring-gray-300
                     {% elif dropdown_button_type == 'dark' %}bg-gray-800 hover:bg-gray-900 text-white focus:ring-gray-700
                     {% else %}bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500{% endif %}
                   {% endif %}
                   {% if dropdown_button_size == 'sm' %}px-3 py-1.5 text-xs
                   {% elif dropdown_button_size == 'lg' %}px-5 py-2.5 text-base
                   {% else %}px-4 py-2 text-sm{% endif %}
                   {{ dropdown_button_class|default:'' }}">
        {{ dropdown_text }}
        {% if icon_class %}
            <i class="{{ icon_class }} ml-2"></i>
        {% else %}
            <svg class="ml-2 -mr-0.5 h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
        {% endif %}
    </button>

    <!-- Dropdown menu -->
    <div id="{{ dropdown_id }}_menu"
         x-show="open"
         x-transition:enter="transition ease-out duration-100"
         x-transition:enter-start="transform opacity-0 scale-95"
         x-transition:enter-end="transform opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-75"
         x-transition:leave-start="transform opacity-100 scale-100"
         x-transition:leave-end="transform opacity-0 scale-95"
         class="absolute z-10 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none
                {% if dropdown_align == 'right' %}right-0 origin-top-right{% else %}left-0 origin-top-left{% endif %}"
         role="menu"
         aria-orientation="vertical"
         aria-labelledby="{{ dropdown_id }}_button"
         style="display: none;">
        <div class="py-1" role="none">
            {% for item in dropdown_items %}
                {% if item.divider %}
                    <div class="border-t border-gray-100 my-1"></div>
                {% else %}
                    <a href="{{ item.url }}" 
                       class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900" 
                       role="menuitem">
                        {% if item.icon_class %}
                            <i class="{{ item.icon_class }} mr-3 text-gray-500"></i>
                        {% endif %}
                        {{ item.text }}
                    </a>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<!-- Add Alpine.js if not already included -->
<script>
if (typeof Alpine === 'undefined') {
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof Alpine === 'undefined') {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js';
            script.defer = true;
            document.head.appendChild(script);
        }
    });
}
</script> 