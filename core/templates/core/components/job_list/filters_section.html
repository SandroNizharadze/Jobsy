{% load i18n %}

<!-- Filtering Section -->
<div id="filters" class="card mb-4 shadow-sm {% if not request.GET.show_filters %}d-none{% endif %}" style="width: 100%; border-radius:18px; background-color:var(--jobsy-yellow); border:none; scroll-margin-top: 100px;">
    <div class="card-body p-4">
        <form method="get" action="{% url 'job_list' %}" id="filter-form" onsubmit="return false;">
            <input type="hidden" name="show_filters" value="1">
            <div class="row g-3">
                <div class="col-12">
                    <input type="text" class="form-control filter-auto-submit" name="search" placeholder="{% trans "მოძებნა / კომპანია" %}" value="{{ request.GET.search|default:'' }}" style="border-radius:8px; padding:10px 15px;">
                </div>
                
                <div class="col-md-3">
                    <select class="form-select filter-auto-submit" name="category" style="border-radius:8px; padding:10px 15px;">
                        <option value="">{% trans "კატეგორია" %}</option>
                        {% for category in categories %}
                            <option value="{{ category }}" {% if request.GET.category == category %}selected{% endif %}>{{ category }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-3">
                    <select class="form-select filter-auto-submit" name="location" style="border-radius:8px; padding:10px 15px;">
                        <option value="">{% trans "ლოკაცია" %}</option>
                        {% for location in locations %}
                            <option value="{{ location }}" {% if request.GET.location == location %}selected{% endif %}>{{ location }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-3">
                    <select class="form-select filter-auto-submit" name="experience" style="border-radius:8px; padding:10px 15px;">
                        <option value="">{% trans "გამოცდილება" %}</option>
                        <option value="entry" {% if request.GET.experience == "entry" %}selected{% endif %}>{% trans "დამწყები" %}</option>
                        <option value="mid" {% if request.GET.experience == "mid" %}selected{% endif %}>{% trans "საშუალო" %}</option>
                        <option value="senior" {% if request.GET.experience == "senior" %}selected{% endif %}>{% trans "პროფესიონალი" %}</option>
                    </select>
                </div>
                
                <div class="col-md-3">
                    <select class="form-select filter-auto-submit" name="premium_level" style="border-radius:8px; padding:10px 15px;">
                        <option value="">{% trans "Premium Level" %}</option>
                        <option value="standard" {% if request.GET.premium_level == "standard" %}selected{% endif %}>Standard</option>
                        <option value="premium" {% if request.GET.premium_level == "premium" %}selected{% endif %}>Premium</option>
                        <option value="premium_plus" {% if request.GET.premium_level == "premium_plus" %}selected{% endif %}>Premium +</option>
                    </select>
                </div>
            </div>
            
            <div class="mt-3">
                <label class="form-label">{% trans "მინიმალური ანაზღაურება" %}</label>
                <input type="range" class="form-range filter-auto-submit" min="0" max="10000" step="500" name="salary_min" value="{{ request.GET.salary_min|default:0 }}" id="salary-slider">
                <div class="d-flex justify-content-between">
                    <span id="salary-value">₾ {{ request.GET.salary_min|default:0 }}</span>
                    <span>₾ 10,000+</span>
                </div>
            </div>
            
            <div class="mt-3">
                <div class="d-flex flex-wrap gap-2">
                    <div class="form-check">
                        <input class="form-check-input filter-auto-submit" type="checkbox" name="job_preferences" value="სრული განაკვეთი" id="full-time" {% if 'სრული განაკვეთი' in job_preferences %}checked{% endif %}>
                        <label class="form-check-label" for="full-time">{% trans "სრული განაკვეთი" %}</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input filter-auto-submit" type="checkbox" name="job_preferences" value="ნახევარი განაკვეთი" id="part-time" {% if 'ნახევარი განაკვეთი' in job_preferences %}checked{% endif %}>
                        <label class="form-check-label" for="part-time">{% trans "ნახევარი განაკვეთი" %}</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input filter-auto-submit" type="checkbox" name="job_preferences" value="დისტანციური" id="remote" {% if 'დისტანციური' in job_preferences %}checked{% endif %}>
                        <label class="form-check-label" for="remote">{% trans "დისტანციური" %}</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input filter-auto-submit" type="checkbox" name="job_preferences" value="სტაჟირება" id="internship" {% if 'სტაჟირება' in job_preferences %}checked{% endif %}>
                        <label class="form-check-label" for="internship">{% trans "სტაჟირება" %}</label>
                    </div>
                </div>
            </div>
            
            <div class="d-flex justify-content-end mt-4">
                <a href="{% url 'job_list' %}?show_filters=1" class="btn btn-outline-secondary" style="border-radius:12px; padding:10px 20px;">
                    <i class="fas fa-redo me-2"></i>{% trans "გასუფთავება" %}
                </a>
            </div>
        </form>
    </div>
</div>

<div class="d-flex justify-content-between align-items-center mb-4" >
    <h2 style="font-weight:700; font-size:1.8rem;">{% trans "ვაკანსიები" %} 
        {% if filtered %}
            <small>({{ jobs|length }} {% trans "შედეგი" %})</small>
        {% elif show_filters %}
            <small>({{ jobs|length }} {% trans "შედეგი" %})</small>
        {% endif %}
    </h2>
    {% if not request.GET.show_filters %}
    <a href="{% url 'job_list' %}?show_filters=1#filters" class="btn btn-primary">
        <i class="fas fa-filter me-2"></i>{% trans "ფილტრები" %}
    </a>
    {% endif %}
    {% if filtered %}
    <div class="active-filters d-flex flex-wrap gap-2">
        {% for filter_name, filter_value in active_filters.items %}
            <div class="badge bg-light text-dark p-2">
                {{ filter_name }}: {{ filter_value }}
                <a href="{% url 'job_list' %}?show_filters=1" class="ms-1 text-danger"><i class="fas fa-times"></i></a>
            </div>
        {% endfor %}
    </div>
    {% endif %}
</div> 